{% extends "blog/base.html" %}
{% load static %}

{% block title %}Search Results{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2>Search Results</h2>

  <!-- Search form -->
  <form method="get" action="{% url 'post_search' %}" class="mb-3">
    <input type="text" name="q" value="{{ query }}" placeholder="Search posts..." />
    <button type="submit">Search</button>
  </form>

  {% if posts %}
    <div class="list-group">
      {% for post in posts %}
      <a href="{% url 'post_detail' post.pk %}" class="list-group-item list-group-item-action mb-3">
        <h3>{{ post.title }}</h3>
        <p>{{ post.content|truncatewords:30 }}</p>
        <small>By {{ post.author.username }} on {{ post.created_at|date:"F j, Y, g:i a" }}</small>
        
        <!-- ðŸ”– Tags -->
        {% if post.tags.all %}
          <p>
            <strong>Tags:</strong>
            {% for tag in post.tags.all %}
              <a href="{% url 'posts_by_tag' tag.name %}" class="tag-link">{{ tag.name }}</a>
              {% if not forloop.last %}, {% endif %}
            {% endfor %}
          </p>
        {% endif %}
      </a>
      {% endfor %}
    </div>
  {% else %}
    <p>No posts found for <strong>{{ query }}</strong>.</p>
  {% endif %}
</div>
{% endblock %}
